<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>5.5 - Example 1: One Color per Model &mdash; LearnWebGL</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.0.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/video.css" type="text/css" />
    <link rel="stylesheet" href="../_static/poll.css" type="text/css" />
    <link rel="stylesheet" href="../_static/tabbedstuff.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pytutor.css" type="text/css" />
    <link rel="stylesheet" href="../_static/modal-basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/codemirror.css" type="text/css" />
    <link rel="stylesheet" href="../_static/activecode.css" type="text/css" />
    <link rel="stylesheet" href="../_static/parsons.css" type="text/css" />
    <link rel="stylesheet" href="../_static/lib/prettify.css" type="text/css" />
    <link rel="stylesheet" href="../_static/codemirror.css" type="text/css" />
    <link rel="stylesheet" href="../_static/webglcode.css" type="text/css" />
    <link rel="stylesheet" href="../_static/webglcodedemo.css" type="text/css" />
    <link rel="stylesheet" href="../_static/matrixeq.css" type="text/css" />
    <link rel="stylesheet" href="../_static/jquery-ui-1.10.3.custom.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/user-highlights.css" type="text/css" />
    <link rel="stylesheet" href="../_static/runestone-custom-sphinx-bootstrap.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/poll.js"></script>
    <script type="text/javascript" src="../_static/d3.v2.min.js"></script>
    <script type="text/javascript" src="../_static/jquery.ba-bbq.min.js"></script>
    <script type="text/javascript" src="../_static/jquery.jsPlumb-1.3.10-all-min.js"></script>
    <script type="text/javascript" src="../_static/pytutor.js"></script>
    <script type="text/javascript" src="../_static/jquery.highlight.js"></script>
    <script type="text/javascript" src="../_static/bookfuncs.js"></script>
    <script type="text/javascript" src="../_static/codemirror.js"></script>
    <script type="text/javascript" src="../_static/xml.js"></script>
    <script type="text/javascript" src="../_static/css.js"></script>
    <script type="text/javascript" src="../_static/htmlmixed.js"></script>
    <script type="text/javascript" src="../_static/python.js"></script>
    <script type="text/javascript" src="../_static/javascript.js"></script>
    <script type="text/javascript" src="../_static/activecode.js"></script>
    <script type="text/javascript" src="../_static/skulpt.min.js"></script>
    <script type="text/javascript" src="../_static/skulpt-stdlib.js"></script>
    <script type="text/javascript" src="../_static/assess.js"></script>
    <script type="text/javascript" src="../_static/animationbase.js"></script>
    <script type="text/javascript" src="../_static/lib/jquery.min.js"></script>
    <script type="text/javascript" src="../_static/lib/jquery-ui.min.js"></script>
    <script type="text/javascript" src="../_static/lib/prettify.js"></script>
    <script type="text/javascript" src="../_static/lib/underscore-min.js"></script>
    <script type="text/javascript" src="../_static/lib/lis.js"></script>
    <script type="text/javascript" src="../_static/parsons.js"></script>
    <script type="text/javascript" src="../_static/parsons-noconflict.js"></script>
    <script type="text/javascript" src="../_static/codemirror.js"></script>
    <script type="text/javascript" src="../_static/xml.js"></script>
    <script type="text/javascript" src="../_static/css.js"></script>
    <script type="text/javascript" src="../_static/htmlmixed.js"></script>
    <script type="text/javascript" src="../_static/javascript.js"></script>
    <script type="text/javascript" src="../_static/webglcode.js"></script>
    <script type="text/javascript" src="../_static/FileSaver.min.js"></script>
    <script type="text/javascript" src="../_static/Blob.js"></script>
    <script type="text/javascript" src="../_static/matrixeq.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/jquery-ui-1.10.3.custom.min.js"></script>
    <script type="text/javascript" src="../_static/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.0.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <script type="text/javascript" src="../_static/waypoints.min.js"></script>
    <script type="text/javascript" src="../_static/rangy-core.js"></script>
    <script type="text/javascript" src="../_static/rangy-textrange.js"></script>
    <script type="text/javascript" src="../_static/rangy-cssclassapplier.js"></script>
    <script type="text/javascript" src="../_static/user-highlights.js"></script>
    <script type="text/javascript" src="../_static/jquery.idle-timer.js"></script>
    <script type="text/javascript" src="../_static/processing-1.4.1.min.js"></script>
    <script type="text/javascript" src="../_static/jquery.hotkey.js"></script>
    <script type="text/javascript" src="../_static/jquery-migrate-1.2.1.min.js"></script>
    <link rel="top" title="LearnWebGL" href="../index.html" />
    <link rel="next" title="5.6 - Example 2: One Color per Triangle" href="render_example_02.html" />
    <link rel="prev" title="5.4 - A Simple Model" href="simple_model.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
<script type="text/javascript">
  eBookConfig = {};
  eBookConfig.host = 'http://127.0.0.1:8000' ? 'http://127.0.0.1:8000' : 'http://127.0.0.1:8000';
  eBookConfig.app = eBookConfig.host+'/runestone';
  eBookConfig.ajaxURL = eBookConfig.app+'/ajax/';
  eBookConfig.course = 'LearnWebGL';
  eBookConfig.logLevel = 10;
  eBookConfig.loginRequired = false
  eBookConfig.build_info = "";
  eBookConfig.isLoggedIn = false;
</script>

<div id="fb-root"></div>
<script>
  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&status=0";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));
</script>



  </head>
  <body role="document">


<!-- Begin navbar -->
<div id="navbar" class="navbar navbar-default navbar-fixed-top" role="navigation">

  <div class="container">

    <div class="navbar-header">
      <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
      <button type='button' class='navbar-toggle' data-toggle="collapse" data-target=".navbar-ex1-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div>
        <a class="brand-logo" style='background: transparent url("../_static/img/logo_small.png") no-repeat 0px 0px;' href="/runestone/default/user/login">&nbsp; </a>
        <a class="navbar-brand" href="../index.html">Learn WebGL</a>
      </div>
    </div>

    <div class="navbar-collapse collapse navbar-ex1-collapse">

      <ul class="nav navbar-nav navbar-right">

        <li class="divider-vertical"></li>

        <!-- social media dropdown -->
        <!--
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-share-alt" style="opacity: 0.9"></i>
          </a>
          <ul class="dropdown-menu social-menu">
              <li>
                <div>
                  <b>Runestone in social media:</b>
                </div>
                <a href="https://twitter.com/iRunestone" class="twitter-follow-button" data-show-count="true">Follow @iRunestone</a><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
                <div class="fb-like" data-href="https://www.facebook.com/RunestoneInteractive" data-send="false" data-layout="button_count" data-width="300" data-show-faces="false" data-font="arial"></div>
              </li>

              <li class="divider"></li>
              <li>
                <div>
                  <b>Help support us:</b>
                </div>
                <div class="gittip">
                  <iframe style="border:0;"
                    src="https://www.gittip.com/bnmnetp/widget.html"
                    width="48pt" height="22pt" class="gittip-button">
                  </iframe>
                </div>
                <div>
                    <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
                  <input type="hidden" name="cmd" value="_s-xclick">
                  <input type="hidden" name="encrypted" value="-----BEGIN PKCS7-----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-----END PKCS7-----
                  ">
                  <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_SM.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
                  <img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
                  </form>

                </div>
              </li>
          </ul>
        </li>
        -->
        <!-- end social media dropdown -->

        <li class="divider-vertical"></li>

        <!-- search dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-search" style='opacity:0.9;'></i>
          </a>
          <ul class='dropdown-menu'>
            
                <li><a href='../index.html'>Table of Contents</a></li>
            
            <!-- <li><a href='/runestone/static/LearnWebGL/genindex.html'>Book Index</a></li> -->
            <li><a href='/LearnWebGL/genindex.html'>Book Index</a></li>
            <!--
            <li class="divider"></li>
            <li id="scratch_ac_link"><a href="javascript:toggleScratchActivecode()">Scratch ActiveCode</a></li>
            <li class="divider"></li>
            -->
            <li style="width: 240px;">
              <form class="navbar-search" style="margin:10px;" action="../search.html" method="get">
                <div class="input-group">
                  <input type="text" class="form-control" name="q" placeholder="Search this book" />
                  <span class="input-group-btn">
                    <button class="btn btn-primary" style="margin:0;" type="submit">
                      <i class="glyphicon glyphicon-search"></i>
                    </button>
                  </span>
                </div><!-- /input-group -->
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
            </li>
          </ul>
        </li>
        <!-- end search dropdown -->

        <li class="divider-vertical"></li>

        <!-- user account dropdown -->
        <!--
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-user" style="opacity:0.9;"></i>
          </a>
          <ul class="dropdown-menu user-menu">
            <li><span class='loggedinuser'></span></li>
            <li class="divider"></li>
            <li><a href='http://127.0.0.1:8000/runestone/mygroup/initiateGroup' id="joinGroupLink">Join a Study Group</a></li>
            <li><a href='http://127.0.0.1:8000/runestone/mygroup/schedule' id="groupScheduleLink">Group Schedule</a></li>
            <li><a href='http://127.0.0.1:8000/runestone/mygroup/newschedule' id="newChapterLink">Schedule New Chapter</a></li>
            <li><a href='http://127.0.0.1:8000/runestone/mygroup/manageGroup' id="manageGroupLink">Manage Group</a></li>
			<li class="divider"></li>
            <li><a href='http://127.0.0.1:8000/runestone/admin/index'>Instructor's Page</a></li>
            <li><a href='http://127.0.0.1:8000/runestone/assignments/index'>Progress Page</a></li>
            <li class="divider"></li>
            <li><a href="http://127.0.0.1:8000/runestone/default/user/profile" id="profilelink">Edit Profile</a></li>
            <li><a href="http://127.0.0.1:8000/runestone/default/user/change_password" id="passwordlink">Change Password</a></li>
            <li><a href="http://127.0.0.1:8000/runestone/default/user/register" id="registerlink">Register</a></li>
            <li class='loginout'><a href='#'>Login</a></li> -- correct link populated by addNavbarLoginLink()
          </ul>
        </li>
        -->
        <!-- end user account dropdown -->

        <li class="divider-vertical"></li>

        <!-- help menu dropdown -->
        <!--
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-question-sign" style="opacity:0.9;"></i>
          </a>
          <ul class="dropdown-menu user-menu">
            <li><a href='/runestone/static/LearnWebGL/navhelp.html'>Navigation Help</a></li>
            <li><a href='/runestone/static/overview/instructor.html'>Help for Instructors</a></li>
            <li class="divider"></li>
            <li><a href='http://runestoneinteractive.org'>About Runestone</a></li>
            <li><a href='https://github.com/bnmnetp/runestone/issues/new'>Report A Problem</a></li>
          </ul>
        </li>
        -->
        <!-- end help menu dropdown -->

        <li class="divider-vertical"></li>

      </ul>

      <ul class="nav navbar-nav">
        <li class="divider-vertical"></li>
        <!--
          <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"><ul>
<li><a class="reference internal" href="#">5.5 - Example 1: One Color per Model</a><ul>
<li><a class="reference internal" href="#the-shader-programs">The Shader Programs</a><ul>
<li><a class="reference internal" href="#vertex-shader">Vertex Shader</a></li>
<li><a class="reference internal" href="#fragment-shader">Fragment Shader</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-buffer-object-s">The Buffer Object(s)</a></li>
<li><a class="reference internal" href="#access-to-shader-variables">Access to Shader Variables</a></li>
<li><a class="reference internal" href="#linking-a-buffer-object-to-an-attribute-variable">Linking a Buffer Object to an Attribute Variable</a></li>
<li><a class="reference internal" href="#rendering">Rendering</a></li>
<li><a class="reference internal" href="#summary">Summary</a></li>
</ul>
</li>
</ul>
</ul>
</li>
          <li class="divider-vertical"></li>
        
        
          
  <li id="relations-prev" title="Previous Chapter - 5.4 - A Simple Model" data-toggle="tooltip">
    <a href="simple_model.html" >
      <i class='glyphicon glyphicon-backward' style='opacity:0.9;'></i>
    </a>
  </li>
  
  <li id="relations-next" title='Next Chapter - 5.6 - Example 2: One Color per Triangle' data-toggle="tooltip" >
    <a href="render_example_02.html" >
      <i class='glyphicon glyphicon-forward' style='opacity:0.9;'></i>
    </a>
  </li>
  <li class="divider-vertical"></li>

<script type="text/javascript">
  opts = {'placement':'bottom',
          'selector': '',
          'delay': { show: 100, hide: 50}
         };

  $('#relations-prev').tooltip(opts);
  $('#relations-next').tooltip(opts);
</script>
        -->
        
          <li></li>
        
      </ul>

    </div>
  </div>
</div>


<div class="container" id="continue-reading"></div>

<div class="container" id="main-content">
  
  <div class="section" id="example-1-one-color-per-model">
<h1>5.5 - Example 1: One Color per Model<a class="headerlink" href="#example-1-one-color-per-model" title="Permalink to this headline">¶</a></h1>
<p>We will render our simple pyramid model using a single color for all its
faces. We need to examine the following issues:</p>
<ul class="simple">
<li>How does the shader program process the model vertices?</li>
<li>How is the model data organized in an <em>object buffer</em>?</li>
<li>How is rendering actually performed?</li>
</ul>
<div class="section" id="the-shader-programs">
<h2>The Shader Programs<a class="headerlink" href="#the-shader-programs" title="Permalink to this headline">¶</a></h2>
<p>Examine the shader programs in the following demo and then study their
descriptions below.</p>
<!-- webgl start -->
  <script>
    var W1_directive = new Webgl_directive( 'W1' );
  </script>
  <div class='webgl_container' id='W1_webgl_container'>
<div class='webgl_cmds' id='W1_webgl_cmds'>
<button class='btn btn-success' id='W1_runb' onclick='W1_program.reload();'>Re-start</button>
Show:
<input type='checkbox' id='W1_show_code' onclick='W1_directive.show_webgl("W1_show_code",1);' checked='checked' /> Code
<input type='checkbox' id='W1_show_canvas' onclick='W1_directive.show_webgl("W1_show_canvas",2);' checked='checked' /> Canvas
<input type='checkbox' id='W1_show_info' onclick='W1_directive.show_webgl("W1_show_info",3);'/> Run Info
<button class='btn btn-default' id='W1_saveall' onclick='W1_program.downloadAll();'>Download All</button>
</div>
<div class='webgl_row2' id='W1_webgl_row2'>
<div class='webgl_editors' id='W1_webgl_editors'>
<ul class='webgl_nav_tabs' id='W1_tab'>
<li>
    <a data-toggle='tab' href='#W1_shader01_vert'><span>shader01.vert</span></a>
</li>

<li>
    <a data-toggle='tab' href='#W1_shader01_frag'><span>shader01.frag</span></a>
</li>
</ul><div style='width:100%; position:relative;'>
<div class="webgl_code"><div class='webgl_tab_content' id='W1_shader01_vert'>
<textarea id="W1_shader01_vert_textarea" class="webgl_tabbed_editor">
// Vertex Shader
// By: Dr. Wayne Brown, Spring 2016

precision mediump int;
precision mediump float;

uniform   mat4 u_Transform;
uniform   vec4 u_Color;

attribute vec3 a_Vertex;

void main() {
  // Transform the location of the vertex
  gl_Position = u_Transform * vec4(a_Vertex, 1.0);
}

</textarea>

<script>
    W1_directive.createCodeMirrorEditor('W1_shader01_vert', 'shader01.vert', 'vert' );
</script>
</div><div class='webgl_tab_content' id='W1_shader01_frag'>
<textarea id="W1_shader01_frag_textarea" class="webgl_tabbed_editor">
// Fragment shader
// By: Dr. Wayne Brown, Spring 2016

precision mediump int;
precision mediump float;

uniform vec4 u_Color;

void main() {
  gl_FragColor = u_Color;
}

</textarea>

<script>
    W1_directive.createCodeMirrorEditor('W1_shader01_frag', 'shader01.frag', 'frag' );
</script>
</div>
<div style="clear:both;"></div>
</div>
</div>
</div>
<div class='webgl_canvas' id='W1_webgl_canvas'><span style="display: none;">./simple_pyramid/simple_pyramid.html</span>
<p>A simple, manually defined 3D model. You can spin the model with your mouse.</p>

<!--The canvas window for rendering 3D graphics -->
<canvas id="W1_canvas" class="canvas3D">
  Please use a browser that supports "canvas"
</canvas>
<br>

<!-- An HTML control element that can be used to modify the rendering behavior -->
<input type="checkbox" id="my_pause" checked> Animate<br>

<!-- Load the JavaScript libraries and data files for the WebGL rendering -->
<script src="../lib/learn_webgl.js"></script>
<script src="../lib/learn_webgl_console_messages.js"></script>
<script src="../lib/learn_webgl_point4.js"></script>
<script src="../lib/learn_webgl_vector3.js"></script>
<script src="../lib/learn_webgl_matrix.js"></script>
<script src="./simple_pyramid/simple_model_01.js"></script>
<script src="./simple_pyramid/simple_model_render_01.js"></script>
<script src="./simple_pyramid/simple_pyramid_render_01.js"></script>
<script src="./simple_pyramid/simple_pyramid_events_01.js"></script>

<!--
  Create an instance of the learn_webgl class, and start the WebGL program.
  We do this here to pass the canvas ID into the javascript code.
-->
<script>
  var models = [];
  var shaders = ["../lib/shaders/shader01.vert", "../lib/shaders/shader01.frag"];
  var controls = ["my_pause"];
  var W1_program = new Learn_webgl("W1_canvas", "SceneSimplePyramidRender", models, shaders, controls, W1_directive);
</script>

</div>
<div style='clear:both;'></div></div>
<div class='webgl_output' id='W1_webgl_output'>
<div>
<input type="checkbox" id="W1_webgl_displayErrors" name="Display" value="Errors" checked='checked' />
<span id="webgl_errorMessages">Shader errors</span>,
<input type="checkbox" id="W1_webgl_displayWarnings" name="Display" value="Warnings" checked='checked' />
<span id="webgl_warningMessages">Shader warnings</span>,
<input type="checkbox" id="W1_weggl_displayInfo" name="Display" value="InfoMessages" checked='checked' />
<span id="infoMessages">Javascript info</span>
</div>

<div id="W1_webgl_output_div" class="webgl_output_div">
</div>
</div>
<div style='clear:both;'></div>
<a href="simple_pyramid/simple_pyramid.html" target="_blank">Open this webgl program in a new tab or window</a></div>
<!-- webgl end --><p> </p>

    <script type='text/javascript'>
        W1_directive.show_webgl("W1_show_code",1);
        W1_directive.show_webgl("W1_show_canvas",2);
        W1_directive.show_webgl("W1_show_info",3);
        W1_directive.set_canvas_height(0);
        W1_directive.set_height_of_webgl_editors("W1",0);
        W1_directive.bring_first_editor_to_front("W1");
    </script>
<div class="section" id="vertex-shader">
<h3>Vertex Shader<a class="headerlink" href="#vertex-shader" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="91%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" rowspan="2">Lines</th>
<th class="head" rowspan="2">Description</th>
</tr>
<tr class="row-even"></tr>
</thead>
<tbody valign="top">
<tr class="row-odd"><td rowspan="8">7-8</td>
<td rowspan="8">The model will be rendered with the same transformation matrix for all
vertices. And all faces will be rendered with the same color. These are
<code class="code docutils literal"><span class="pre">uniform</span></code> values that will be set once before a rendering starts.
Notice the convention to start their names with a <strong>u_</strong>. This will
help you track the types of your variables. (WebGL shaders could care
less what you name your variables. This convention is for you - the
programmer!)</td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2">7</td>
<td rowspan="2">a <code class="code docutils literal"><span class="pre">mat4</span></code> is a 4x4 matrix; 16 floating point values.</td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="3">8</td>
<td rowspan="3">a <code class="code docutils literal"><span class="pre">vec4</span></code> is a vector of 4 floating point values; in this case a
color defined as RGBA (red, green, blue, alpha).</td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"><td rowspan="5">10</td>
<td rowspan="5">The vertices will change for every triangle that is rendered. Therefore
the variable, <code class="code docutils literal"><span class="pre">a_Vertex</span></code>, is an attribute variable. It will get
its values from a <em>buffer object</em>. A <code class="code docutils literal"><span class="pre">vec3</span></code> is an array of 3
floating point values; (x,y,z).</td>
</tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="3">12-15</td>
<td rowspan="3">The <code class="code docutils literal"><span class="pre">main()</span></code> function is always the entry point for a shader. This
function will be executed once for each vertex in the model.</td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"><td rowspan="7">14</td>
<td rowspan="7">This shader executes a single command on each vertex. It is multiplying
a 4x4 matrix times a 4x1 vector using linear algebra matrix mulplication.
WebGL shaders have matrix math built-in! Notice that the vertex has only
three values (x,y,z) but 4 values are required for the matrix
multiplication. The vertex is converted to a 4-component array, with the
last component, the <code class="code docutils literal"><span class="pre">w</span></code> component, set to 1.0.</td>
</tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
</tbody>
</table>
</div>
<div class="section" id="fragment-shader">
<h3>Fragment Shader<a class="headerlink" href="#fragment-shader" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="91%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" rowspan="2">Lines</th>
<th class="head" rowspan="2">Description</th>
</tr>
<tr class="row-even"></tr>
</thead>
<tbody valign="top">
<tr class="row-odd"><td rowspan="5">7</td>
<td rowspan="5">The color of the pixels will be the same, so we have one <code class="code docutils literal"><span class="pre">uniform</span></code>
value, <code class="code docutils literal"><span class="pre">u_Color</span></code>. Because the variable is global and has the same
name as a global <em>vertex shader</em> variable, the variable is linked to the
<em>vertex shader</em>&#8216;s variable of the same name.</td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"><td rowspan="4">9-11</td>
<td rowspan="4">The <code class="code docutils literal"><span class="pre">main()</span></code> function is always the entry point for a shader. This
function will be executed once for each fragment of the rendered
primitive (either a point, line or triangle.)</td>
</tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"><td rowspan="3">10</td>
<td rowspan="3">This shader executes a single command on each fragment. It is setting
the color of the fragment.</td>
</tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="the-buffer-object-s">
<h2>The Buffer Object(s)<a class="headerlink" href="#the-buffer-object-s" title="Permalink to this headline">¶</a></h2>
<p>The only attribute that is changing to render this model is its vertices.
Therefore, we only need one <em>buffer object</em>. Remember that a <em>buffer object</em>
is a 1-dimensional, homogeneous array of floating point values.
We need to gather up all of the vertices that define
the triangles into a single array, and the order of the vertices matter.
Before you create the array you need to
decide how the triangles will be rendered. There are three choices:
<code class="code docutils literal"><span class="pre">gl.TRIANGLE</span></code>, <code class="code docutils literal"><span class="pre">gl.TRIANGLE_STRIP</span></code>, or <code class="code docutils literal"><span class="pre">g.TRIANGLE_FAN</span></code>.
In addition, the vertices of each triangle must be in counter-clockwise order
when looking at the front of the face. Our pyramid model can be rendered
in a single &#8216;pass&#8217; through the <em>buffer object</em> using either the <code class="code docutils literal"><span class="pre">gl.TRIANGLE</span></code>
or the <code class="code docutils literal"><span class="pre">gl.TRIANGLE_STRIP</span></code> mode. Let&#8217;s keep it simple and use the
<code class="code docutils literal"><span class="pre">gl.TRIANGLE</span></code> mode for this example. (If you changed rendering modes,
you would have to change the ordering of the vertices.)</p>
<p>Creating the <em>buffer object</em> is a pre-processing step which needs to happen
only once. Let&#8217;s break the task into 2 parts:</p>
<ul class="simple">
<li>Get the triangle vertices into a 1D array in the correct order. This is
done by the <code class="code docutils literal"><span class="pre">_buildBufferObjectData()</span></code> function in the code shown below.</li>
<li>Create and upload the vertices into the GPU&#8217;s memory. This is done by the
<code class="code docutils literal"><span class="pre">_createBufferObject()</span></code> function in the code shown below.</li>
</ul>
<p>Note that these two functions are private functions of the JavaScript class
definition and they are only called once when the constructor code is executed.</p>
<p>The 1D array that is created to fill the <em>buffer object</em> contains the data
below for this example. Note that each consecutive three values represent
one vertex.</p>
<div class="highlight-JavaScript"><div class="highlight"><pre><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">]</span>
</pre></div>
</div>
<!-- webgl start -->
  <script>
    var W2_directive = new Webgl_directive( 'W2' );
  </script>
  <div class='webgl_container' id='W2_webgl_container'>
<div class='webgl_cmds' id='W2_webgl_cmds'>
<button class='btn btn-success' id='W2_runb' onclick='W2_program.reload();'>Re-start</button>
Show:
<input type='checkbox' id='W2_show_code' onclick='W2_directive.show_webgl("W2_show_code",1);' checked='checked' /> Code
<input type='checkbox' id='W2_show_canvas' onclick='W2_directive.show_webgl("W2_show_canvas",2);' checked='checked' /> Canvas
<input type='checkbox' id='W2_show_info' onclick='W2_directive.show_webgl("W2_show_info",3);'/> Run Info
<button class='btn btn-default' id='W2_saveall' onclick='W2_program.downloadAll();'>Download All</button>
</div>
<div class='webgl_row2' id='W2_webgl_row2'>
<div class='webgl_editors' id='W2_webgl_editors'>
<ul class='webgl_nav_tabs' id='W2_tab'>
<li>
    <a data-toggle='tab' href='#W2_simple_model_render_01_js'><span>simple_model_render_01.js</span></a>
</li>
</ul><div style='width:100%; position:relative;'>
<div class="webgl_code"><div class='webgl_tab_content' id='W2_simple_model_render_01_js'>
<textarea id="W2_simple_model_render_01_js_textarea" class="webgl_tabbed_editor">
/**
 * simple_model_render_01.js, By Wayne Brown, Fall 2015
 */

/**
 * The MIT License (MIT)
 *
 * Copyright (c) 2015 C. Wayne Brown
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

"use strict";

//-------------------------------------------------------------------------
/**
 * Given a model description, create the buffer objects needed to render
 * the model. This is very closely tied to the shader implementations.
 * @param gl Object The WebGL state and API
 * @param program Object The shader program the will render the model.
 * @param model Simple_model The model data.
 * @param model_color The color of the model faces.
 * @param out Object Can display messages to the webpage.
 * @constructor
 */
window.SimpleModelRender_01 = function (gl, program, model, model_color, out) {

  var self = this;

  // Variables to remember so the model can be rendered.
  var number_triangles = 0;
  var triangles_vertex_buffer_id = null;

  // Shader variable locations
  var a_Vertex_location = null;
  var u_Color_location = null;
  var u_Transform_location = null;

  var edge_color = new Float32Array( [0.0, 0.0, 0.0, 1.0]); // BLACK

  //-----------------------------------------------------------------------
  /**
   * Create a Buffer Object in the GPU's memory and upload data into it.
   * @param gl Object The WebGL state and API
   * @param data TypeArray An array of data values.
   * @returns Number a unique ID for the Buffer Object
   * @private
   */
  function _createBufferObject(gl, data) {
    // Create a buffer object
    var buffer_id;

    buffer_id = gl.createBuffer();
    if (!buffer_id) {
      out.displayError('Failed to create the buffer object for ' + model.name);
      return null;
    }

    // Make the buffer object the active buffer.
    gl.bindBuffer(gl.ARRAY_BUFFER, buffer_id);

    // Upload the data for this buffer object to the GPU.
    gl.bufferData(gl.ARRAY_BUFFER, data, gl.STATIC_DRAW);

    return buffer_id;
  }

  //-----------------------------------------------------------------------
  /**
   * Using the model data, build a 1D array for the Buffer Object
   * @private
   */
  function _buildBufferObjectData() {
    var j, k, m, nv, numberVertices, triangle, vertex, vertices3;

    // Create a 1D array that holds all of the  for the triangles
    if (model.triangles.length > 0) {
      number_triangles = model.triangles.length;
      numberVertices = number_triangles * 3;
      vertices3 = new Float32Array(numberVertices * 3);

      nv = 0;
      for (j = 0; j < model.triangles.length; j += 1) {
        triangle = model.triangles[j];

        for (k = 0; k < 3; k += 1) {
          vertex = triangle.vertices[k];

          for (m = 0; m < 3; m += 1, nv += 1) {
            vertices3[nv] = vertex[m];
          }
        }
      }

      triangles_vertex_buffer_id = _createBufferObject(gl, vertices3);
    }

    // Release the temporary vertex array so the memory can be reclaimed.
    vertices3 = null;
  }

  //-----------------------------------------------------------------------
  /**
   * Get the location of the shader variables in the shader program.
   * @private
   */
  function _getLocationOfShaderVariables() {
    // Get the location of the shader variables
    u_Color_location     = gl.getUniformLocation(program, 'u_Color');
    u_Transform_location = gl.getUniformLocation(program, 'u_Transform');
    a_Vertex_location    = gl.getAttribLocation(program,  'a_Vertex');
  }

  //-----------------------------------------------------------------------
  // These one-time tasks set up the rendering of the models.
  _buildBufferObjectData();
  _getLocationOfShaderVariables();

  //-----------------------------------------------------------------------
  /**
   * Delete the Buffer Objects associated with this model.
   * @param gl Object The WebGL state and API.
   */
  self.delete = function (gl) {
    if (number_triangles > 0) {
      gl.deleteBuffer(triangles_vertex_buffer_id);
    }
  };

  //-----------------------------------------------------------------------
  /**
   * Render the model.
   * @param gl Object The WebGL state and API.
   * @param transform 4x4Matrix The transformation to apply to the model vertices.
   */
  self.render = function (gl, transform) {
    var j, start;

    // 1. Render the triangles:

    // Set the transform for all the triangle vertices
    gl.uniformMatrix4fv(u_Transform_location, false, transform);

    // Set the color for all of the triangle faces
    gl.uniform4fv(u_Color_location, model_color);

    // Activate the model's vertex Buffer Object
    gl.bindBuffer(gl.ARRAY_BUFFER, triangles_vertex_buffer_id);

    // Bind the vertices Buffer Object to the 'a_Vertex' shader variable
    gl.vertexAttribPointer(a_Vertex_location, 3, gl.FLOAT, false, 0, 0);
    gl.enableVertexAttribArray(a_Vertex_location);

    // Draw all of the triangles
    gl.drawArrays(gl.TRIANGLES, 0, number_triangles * 3);

    // 2. Render the edges around each triangle:

    // Set the color for all of the edges
    gl.uniform4fv(u_Color_location, edge_color);

    // Draw a line_loop around each of the triangles
    for (j = 0, start = 0; j < number_triangles; j += 1, start += 3) {
      gl.drawArrays(gl.LINE_LOOP, start, 3);
    }

  };

};

</textarea>

<script>
    W2_directive.createCodeMirrorEditor('W2_simple_model_render_01_js', 'simple_model_render_01.js', 'js' );
</script>
</div>
<div style="clear:both;"></div>
</div>
</div>
</div>
<div class='webgl_canvas' id='W2_webgl_canvas'><span style="display: none;">./simple_pyramid/simple_pyramid2.html</span>
<p>A simple, manually defined 3D model. You can spin the model with your mouse.</p>

<!--The canvas window for rendering 3D graphics -->
<canvas id="W2_canvas" class="canvas3D">
  Please use a browser that supports "canvas"
</canvas>
<br>

<!-- An HTML control element that can be used to modify the rendering behavior -->
<input type="checkbox" id="my_pause2" checked> Animate<br>

<!-- Load the JavaScript libraries and data files for the WebGL rendering -->
<script src="../lib/learn_webgl.js"></script>
<script src="../lib/learn_webgl_console_messages.js"></script>
<script src="../lib/learn_webgl_point4.js"></script>
<script src="../lib/learn_webgl_vector3.js"></script>
<script src="../lib/learn_webgl_matrix.js"></script>
<script src="./simple_pyramid/simple_model_01.js"></script>
<script src="./simple_pyramid/simple_model_render_01.js"></script>
<script src="./simple_pyramid/simple_pyramid_render_01.js"></script>
<script src="./simple_pyramid/simple_pyramid_events_01.js"></script>

<!--
  Create an instance of the learn_webgl class, and start the WebGL program.
  We do this here to pass the canvas ID into the javascript code.
-->
<script>
  var models = [];
  var shaders = ["../lib/shaders/shader01.vert", "../lib/shaders/shader01.frag"];
  var controls = ["my_pause2"];
  var W2_program = new Learn_webgl("W2_canvas", "SceneSimplePyramidRender", models, shaders, controls, W2_directive);
</script>

</div>
<div style='clear:both;'></div></div>
<div class='webgl_output' id='W2_webgl_output'>
<div>
<input type="checkbox" id="W2_webgl_displayErrors" name="Display" value="Errors" checked='checked' />
<span id="webgl_errorMessages">Shader errors</span>,
<input type="checkbox" id="W2_webgl_displayWarnings" name="Display" value="Warnings" checked='checked' />
<span id="webgl_warningMessages">Shader warnings</span>,
<input type="checkbox" id="W2_weggl_displayInfo" name="Display" value="InfoMessages" checked='checked' />
<span id="infoMessages">Javascript info</span>
</div>

<div id="W2_webgl_output_div" class="webgl_output_div">
</div>
</div>
<div style='clear:both;'></div>
<a href="simple_pyramid/simple_pyramid2.html" target="_blank">Open this webgl program in a new tab or window</a></div>
<!-- webgl end --><p> </p>

    <script type='text/javascript'>
        W2_directive.show_webgl("W2_show_code",1);
        W2_directive.show_webgl("W2_show_canvas",2);
        W2_directive.show_webgl("W2_show_info",3);
        W2_directive.set_canvas_height(0);
        W2_directive.set_height_of_webgl_editors("W2",0);
        W2_directive.bring_first_editor_to_front("W2");
    </script>
</div>
<div class="section" id="access-to-shader-variables">
<h2>Access to Shader Variables<a class="headerlink" href="#access-to-shader-variables" title="Permalink to this headline">¶</a></h2>
<p>To render a model, you will set some values in your shader program and then
issue the <code class="code docutils literal"><span class="pre">gl.drawArrays()</span></code> command. But you have a problem. Your
data is in RAM in your JavaScript program, while your shader program is a
compiled program on the GPU. How can you pass data to the shader? This
is a 2 step process:</p>
<ul class="simple">
<li>Pre-processing: Get the location of a variable in the shader program. This
is equivalent to an index that could be used as an array lookup. The <em>location</em>
of a variable in a shader program will never change, so the location only
needs to be retrieved once.</li>
<li>Use a variable&#8217;s location in a shader program to update it.</li>
</ul>
<p>To get a variable&#8217;s location in a shader program, use one of the appropriate
WebGL functions:</p>
<div class="highlight-JavaScript"><div class="highlight"><pre><span class="nx">uint</span> <span class="nx">getUniformLocation</span><span class="p">(</span><span class="nb">Object</span> <span class="nx">shader_program</span><span class="p">,</span> <span class="nx">string</span> <span class="nx">variable_name</span><span class="p">);</span>
<span class="nx">ulong</span> <span class="nx">getAttribLocation</span><span class="p">(</span><span class="nb">Object</span> <span class="nx">shader_program</span><span class="p">,</span> <span class="nx">string</span> <span class="nx">variable_name</span><span class="p">);</span>
</pre></div>
</div>
<p>Examples of these functions can be found in lines 133-135 of the demo code above.</p>
<p>To set a variable&#8217;s value in a shader program, use one of the appropriate
WebGL functions:</p>
<div class="highlight-JavaScript"><div class="highlight"><pre><span class="k">void</span> <span class="nx">uniform</span><span class="p">[</span><span class="mi">1234</span><span class="p">][</span><span class="nx">fi</span><span class="p">](</span><span class="nx">uint</span> <span class="nx">location</span><span class="p">,</span> <span class="nx">value1</span><span class="p">,</span> <span class="nx">value2</span><span class="p">,</span> <span class="nx">value3</span><span class="p">,</span> <span class="p">...);</span>
<span class="k">void</span> <span class="nx">uniform</span><span class="p">[</span><span class="mi">1234</span><span class="p">][</span><span class="nx">fi</span><span class="p">]</span><span class="nx">v</span><span class="p">(</span><span class="nx">uint</span> <span class="nx">location</span><span class="p">,</span> <span class="nb">Array</span> <span class="nx">values</span><span class="p">);</span>
<span class="k">void</span> <span class="nx">uniformMatrix</span><span class="p">[</span><span class="mi">234</span><span class="p">]</span><span class="nx">fv</span><span class="p">(</span><span class="nx">uint</span> <span class="nx">location</span><span class="p">,</span> <span class="nx">bool</span> <span class="nx">transpose</span><span class="p">,</span> <span class="nb">Array</span> <span class="nx">matrix</span><span class="p">);</span>
</pre></div>
</div>
<p>The characters in brackets, <em>[234]</em>, represent the number of values to be set.
The <em>[fi]</em> means you are setting either a floating point value, <em>f</em>, or an integer
value, <em>i</em>. You can send values as discrete variables, or as multiple values
in a single array. The functions that use arrays end in a <em>v</em>. Examples of setting
the values of shader program variables can be found at lines 158, 161, and 176
in the above demo code.</p>
</div>
<div class="section" id="linking-a-buffer-object-to-an-attribute-variable">
<h2>Linking a Buffer Object to an Attribute Variable<a class="headerlink" href="#linking-a-buffer-object-to-an-attribute-variable" title="Permalink to this headline">¶</a></h2>
<p>An attribute variable pulls its values from an array. The array will typically
be stored in a <em>buffer object</em>. The positions in the array that are used
is determined by the 2<sup>nd</sup> and 3<sup>rd</sup> parameters in your call to
<code class="code docutils literal"><span class="pre">gl.drawArrays(mode,</span> <span class="pre">start,</span> <span class="pre">count)</span></code>. The <code class="code docutils literal"><span class="pre">start</span></code> parameter gives
the starting array index, while the <code class="code docutils literal"><span class="pre">count</span></code> parameter specifies how many
vertices to use. You must enable the use of &#8216;vertex arrays&#8217; before you can
access values from a <em>buffer object</em>. Linking our <code class="code docutils literal"><span class="pre">a_Vertex</span></code> attribute
variable in our shader program to the <em>buffer object</em> looks like this:</p>
<div class="highlight-JavaScript"><div class="highlight"><pre><span class="nx">gl</span><span class="p">.</span><span class="nx">bindBuffer</span><span class="p">(</span><span class="nx">gl</span><span class="p">.</span><span class="nx">ARRAY_BUFFER</span><span class="p">,</span> <span class="nx">triangles_vertex_buffer_id</span><span class="p">);</span>

<span class="nx">gl</span><span class="p">.</span><span class="nx">enableVertexAttribArray</span><span class="p">(</span><span class="nx">a_Vertex_location</span><span class="p">);</span>

<span class="nx">gl</span><span class="p">.</span><span class="nx">vertexAttribPointer</span><span class="p">(</span><span class="nx">a_Vertex_location</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nx">gl</span><span class="p">.</span><span class="nx">FLOAT</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</pre></div>
</div>
<p>First, you must make a particular <em>buffer object</em> active. This is done with the
<code class="code docutils literal"><span class="pre">bindBuffer</span></code> command. Then you enable getting data from <em>buffer objects</em>
with the <code class="code docutils literal"><span class="pre">enableVertexAttribArray</span></code> function. Then you describe the
organization of the values in the <em>buffer object</em> using a call to
<code class="code docutils literal"><span class="pre">vertexAttribPointer</span></code>.
The 1<sup>st</sup> parameter, <em>a_Vertex_location</em>, is the location in the compiled
shader program of the variable that will be set from the buffer&#8217;s values. Let&#8217;s
delay a formal description of the other parameters until later. For now,
the other parameters tell the shader that the vertex data has 3 values per
vertex and the values are all floating point.</p>
</div>
<div class="section" id="rendering">
<h2>Rendering<a class="headerlink" href="#rendering" title="Permalink to this headline">¶</a></h2>
<p>In the example code, the <code class="code docutils literal"><span class="pre">gl.drawArrays(mode,</span> <span class="pre">start,</span> <span class="pre">count)</span></code> command
is called 5 times. (See lines 171 and 180.) Let&#8217;s discuss why.</p>
<p>The shader is written to render with a single color. We want to render
a red pyramid with black edges. Therefore we must call <code class="code docutils literal"><span class="pre">drawArrays()</span></code> at least
twice: once when the color is set to red, and a second time after the color
has been changed to black. Examine the demo code. Notice that the color
is set to red in line 161 and then the triangles are rendered in line 171.
Then the color is changed to black in line 176 (the <code class="code docutils literal"><span class="pre">edge_color</span></code>), and
then the same vertices in the <em>buffer object</em> are used to draw the triangle
edges using the <code class="code docutils literal"><span class="pre">gl.LINE_LOOP</span></code> mode. However, this can&#8217;t be done with
a single draw command because the vertices are not organized that way
in the <em>buffer object</em>. So we have to step through the buffer and change
the starting index each time.</p>
</div>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>In the next few lessons we will modify our model, our shader programs,
and our rendering code to produce more sophisticated graphics. It is important
that you understand the concepts presented above before proceeding to the
next lesson. So make a second pass through this lesson before proceeding.</p>
<span class="target" id="index-0"></span></div>
</div>


  
      
  <li id="relations-prev" class="navLink" title='Previous Section - 5.4 - A Simple Model' data-toggle="tooltip">
    <a href="simple_model.html" >
      <i class='prevNav glyphicon glyphicon-chevron-left'></i>
    </a>
  </li>
  <a class="navLinkBg" id="navLinkBgLeft"  href="simple_model.html" ></a>
  
  <li id="relations-next" class="navLink" title='Next Section - 5.6 - Example 2: One Color per Triangle' data-toggle="tooltip" >
    <a href="render_example_02.html" >
      <i id="relationsNextIcon" class='nextNav glyphicon glyphicon-chevron-right'></i>
    </a>
  </li>
  <a class="navLinkBg navLink" id="navLinkBgRight" href="render_example_02.html" >Next Section - 5.6 - Example 2: One Color per Triangle</a>

<script type="text/javascript">

  $('#relations-prev').tooltip({'placement':'right', 'selector': '', 'delay': { show: 100, hide: 50}});
  $('#relations-next').tooltip({'placement':'left', 'selector': '', 'delay': { show: 100, hide: 50}});
  
</script>
  
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <span id='numuserspan'></span> readers online now | <span class='loggedinuser'></span> | <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright &lt;2015, C. Wayne Brown&gt;.
      Last updated on Mar 04, 2016.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.1.
    </p>
  </div>
</footer>

<script type="text/javascript" charset="utf-8">
    $(document).ready(addUserToFooter);
    $(document).ready(addNavbarLoginLink);
    $(document).ready(createEditors);
    $(document).ready(getNumUsers);
    $(document).ready(getOnlineUsers);
    $(document).ready(createScratchActivecode());
    $(document).ready(styleUnittestResults());
</script>

<script type="text/javascript">
  // add the video play button overlay image
  $(".video-play-overlay").each(function() {
    $(this).css('background-image', "url(\'../_static/play_overlay_icon.png\')")
    });

  // This function is needed to allow the dropdown search bar to work;
  // The default behaviour is that the dropdown menu closes when something in
  // it (like the search bar) is clicked
  $(function() {
    // Fix input element click problem
    $('.dropdown input, .dropdown label').click(function(e) {
      e.stopPropagation();
      });
  });

  // style codelens buttons (doing it here because PyTutor is a submodule owned by someone else
  $(function() {
    $(".ExecutionVisualizer").each(function() {
      $(this).find("#jmpFirstInstr").addClass('btn btn-default');
      $(this).find("#jmpStepBack").addClass('btn btn-danger');
      $(this).find("#jmpStepFwd").addClass('btn btn-success');
      $(this).find("#jmpLastInstr").addClass('btn btn-default');
      });
  });

</script>


<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-32029811-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>



  </body>
</html>